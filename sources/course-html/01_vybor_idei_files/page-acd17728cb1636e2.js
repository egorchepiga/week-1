(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7923],{6001:(e,r,a)=>{"use strict";a.d(r,{default:()=>y});var t=a(83565),s=a(58745),n=a(27959),l=a(1776);a(63104),a(99422),a(69724);var d=a(67571),o=a(39961),i=a(14427),c=a(56584),m=a(13402),u=a(61294),h=a.n(u);let x=(0,l.default)(()=>a.e(4604).then(a.bind(a,54604)).then(e=>e.Code),{loadableGenerated:{webpack:()=>[54604]}}),b=(0,l.default)(()=>Promise.all([a.e(1464),a.e(2190)]).then(a.bind(a,95745)).then(e=>e.Collection),{loadableGenerated:{webpack:()=>[95745]}}),g=(0,l.default)(()=>Promise.all([a.e(8219),a.e(7540)]).then(a.bind(a,27540)).then(e=>e.Equation),{loadableGenerated:{webpack:()=>[27540]}}),p=(0,l.default)(()=>a.e(4346).then(a.bind(a,74346)).then(e=>e.Modal),{loadableGenerated:{webpack:()=>[74346]},ssr:!1}),y=e=>{let{data:r,hideHeader:a,pageId:l,chunks:u,currentPageId:y,lowestLevel:f,basePageUrl:k,otherUserData:v,supabaseUUID:j,lang:w}=e,N=(0,i.Ay)("tg-username",async()=>{let e=(0,c.U)(),{data:{telegram_username:r}}=await e.from("internal_users").select("telegram_username").eq("id",j).single();return r}),{theme:P}=(0,d.D)();return(0,s.useEffect)(()=>{let e=setTimeout(()=>{document.querySelectorAll("iframe").forEach(e=>{try{let r=new URL(e.src);r.searchParams.append("email",v.email),r.searchParams.append("plan",v.plan),r.searchParams.append("team",v.team),r.searchParams.append("batch",v.batch),r.searchParams.append("tg_username",N.data),e.src=r.toString()}catch(r){console.error("Invalid iframe URL:",e.src)}})},3e3);return()=>clearTimeout(e)},[N.data]),(0,t.jsx)("div",{className:"w-full flex flex-col gap-4 max-w-[calc(100vw-30px)] overflow-auto",children:(0,t.jsx)(n.xJ,{mapImageUrl:(e,r)=>{if(!e)return null;if(e.startsWith("data:")||e.startsWith("https://images.unsplash.com"))return e;try{let r=new URL(e);if(r.pathname.startsWith("/secure.notion-static.com")&&r.hostname.endsWith(".amazonaws.com")&&r.searchParams.has("X-Amz-Credential")&&r.searchParams.has("X-Amz-Signature")&&r.searchParams.has("X-Amz-Algorithm"))return e}catch(e){}e.startsWith("/images")&&(e="https://www.notion.so".concat(e));let a=new URL(e="https://www.notion.so".concat(e.startsWith("/image")?e:"/image/".concat(encodeURIComponent(e)))),t="space"===r.parent_table?"block":r.parent_table;return("collection"===t||"team"===t)&&(t="block"),a.searchParams.set("table",t),a.searchParams.set("id",r.id),a.searchParams.set("cache","v2"),e=a.toString(),"/api/notion/media?notion_url=".concat(encodeURIComponent(e))},mapPageUrl:e=>"".concat(k||"/publisher/lessons","/").concat(e),recordMap:r,rootPageId:l,fullPage:!0,darkMode:"dark"===P,previewImages:!0,components:{PageLink:e=>{let{href:r,...a}=e;return(0,t.jsx)("span",{className:"cursor-pointer",children:(0,t.jsx)(m.h,{as:h(),href:r,...a})})},Link:e=>{let{href:r,...a}=e,s=new URL(r),n=r;if("t.me"===s.hostname){let e=new URLSearchParams(s.search).get("start"),r=null==e?void 0:e.split("_");r&&r.length>1&&(n="https://t.me".concat(s.pathname,"?start=").concat(r[0],"_").concat(v.plan,"_").concat(r[2]))}return(0,t.jsx)("span",{className:"cursor-pointer",children:(0,t.jsx)(m.h,{as:h(),href:n,target:"_blank",...a})})},Header:e=>(0,t.jsxs)(t.Fragment,{children:[!a&&(0,t.jsx)(n.Y9,{...e}),f&&u&&(0,t.jsx)(o.A,{lang:w,chunks:u,currentPageId:y})]}),Code:x,Collection:b,Equation:g,Modal:p}})})}},8770:(e,r,a)=>{"use strict";a.d(r,{b:()=>s});var t=a(57108);function s(e,r){let{id:a,"aria-label":s,"aria-labelledby":n}=e;return a=(0,t.Bi)(a),n&&s?n=[...new Set([a,...n.trim().split(/\s+/)])].join(" "):n&&(n=n.trim().split(/\s+/).join(" ")),s||n||!r||(s=r),{id:a,"aria-label":s,"aria-labelledby":n}}},11896:(e,r,a)=>{Promise.resolve().then(a.bind(a,44056)),Promise.resolve().then(a.bind(a,6001))},21667:(e,r,a)=>{"use strict";var t=a(68939);a.o(t,"useParams")&&a.d(r,{useParams:function(){return t.useParams}}),a.o(t,"usePathname")&&a.d(r,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(r,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(r,{useSearchParams:function(){return t.useSearchParams}})},39961:(e,r,a)=>{"use strict";a.d(r,{A:()=>o});var t=a(83565);a(58745);var s=a(29551),n=a(59805),l=a(61294),d=a.n(l);let o=e=>{let{chunks:r,currentPageId:a,lang:l}=e;return r?(0,t.jsx)("div",{className:"flex flex-wrap gap-2",style:{marginTop:20},children:(0,t.jsx)(s.T,{total:r.length,color:"primary",disableAnimation:!0,boundaries:10,initialPage:r.findIndex(e=>e.id===a)+1,renderItem:e=>(0,t.jsx)(n.l,{href:"/publisher/lessons/".concat(r[e.page-1].id),as:d(),...e})})}):null}},44056:(e,r,a)=>{"use strict";a.d(r,{default:()=>o});var t=a(83565),s=a(58745),n=a(45964),l=a(21667),d=a(31881);let o=e=>{let{lang:r,currentAccess:a}=e,[o,i]=(0,s.useState)(!1),[c,m]=(0,s.useState)(""),[u,h]=(0,s.useState)([]),[x,b]=(0,s.useState)(!1),[g,p]=(0,s.useState)(-1),y=(0,l.useRouter)(),f=(0,s.useRef)(null),k=(0,s.useRef)(null),v=(0,s.useCallback)(((e,r)=>{let a;return function(){for(var t=arguments.length,s=Array(t),n=0;n<t;n++)s[n]=arguments[n];clearTimeout(a),a=setTimeout(()=>e(...s),r)}})(async e=>{if(e.trim().length<2){h([]),b(!1);return}b(!0);try{let t=await fetch("/api/notion/search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e,lang:r,currentAccess:a||[]})});if(t.ok){let e=await t.json();h(e.results||[])}else h([])}catch(e){console.error("Search error:",e),h([])}finally{b(!1)}},300),[r,a]);(0,s.useEffect)(()=>{v(c)},[c,v]),(0,s.useEffect)(()=>{let e=e=>{f.current&&!f.current.contains(e.target)&&w()};return o?(document.addEventListener("mousedown",e),document.body.style.overflow="hidden"):document.body.style.overflow="unset",()=>{document.removeEventListener("mousedown",e),document.body.style.overflow="unset"}},[o]),(0,s.useEffect)(()=>{let e=e=>{if(!o){(e.metaKey||e.ctrlKey)&&"k"===e.key&&(e.preventDefault(),j());return}switch(e.key){case"Escape":e.preventDefault(),w();break;case"ArrowDown":e.preventDefault(),p(e=>e<u.length-1?e+1:e);break;case"ArrowUp":e.preventDefault(),p(e=>e>0?e-1:-1);break;case"Enter":e.preventDefault(),g>=0&&u[g]&&N(u[g])}};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[o,u,g]);let j=()=>{i(!0),setTimeout(()=>{var e;null==(e=k.current)||e.focus()},100)},w=()=>{i(!1),m(""),h([]),p(-1)},N=e=>{let r="/publisher/lessons/".concat(e.id);y.push(r),w()};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{onClick:j,className:"absolute md:fixed top-4 right-[140px] md:right-5 flex items-center gap-2 px-3 py-2 text-sm bg-default-50  hover:bg-default-200 border border-gray-300 dark:border-gray-600 rounded-lg transition-colors","aria-label":"Open search",children:[(0,t.jsx)(n.uBk,{size:16,className:"text-gray-500 dark:text-gray-400"}),(0,t.jsx)("span",{className:"hidden sm:inline text-gray-600 dark:text-gray-300",children:"Search"}),(0,t.jsx)("kbd",{className:"hidden sm:inline-flex items-center px-1.5 py-0.5 text-xs bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded",children:"⌘K"})]}),o&&(0,t.jsxs)("div",{className:"fixed inset-0 z-[99999] flex items-start justify-center pt-[10vh] px-4",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),(0,t.jsxs)("div",{ref:f,className:"relative w-full max-w-2xl bg-white dark:bg-gray-900 rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-700 overflow-hidden animate-in slide-in-from-top-4 duration-200",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,t.jsx)("div",{className:"flex items-center justify-center w-10 h-10 bg-blue-500 rounded-xl",children:(0,t.jsx)(n.uBk,{className:"w-5 h-5 text-white"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Поиск по урокам"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Найдите нужный урок или материал быстро и легко"})]}),(0,t.jsx)("button",{onClick:w,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:(0,t.jsx)(n.Qks,{size:20})})]}),(0,t.jsx)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(n.uBk,{size:20,className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,t.jsx)(d.r,{ref:k,value:c,onChange:e=>m(e.target.value),placeholder:"Введите название урока или ключевые слова...",className:"w-full",classNames:{input:"pl-12 pr-10 text-base placeholder:text-gray-400",inputWrapper:"h-12 border-2 border-gray-200 dark:border-gray-600 hover:border-blue-300 dark:hover:border-blue-500 focus-within:border-blue-500 dark:focus-within:border-blue-400 rounded-xl"},autoComplete:"off"}),c&&(0,t.jsx)("button",{onClick:()=>{var e;m(""),h([]),p(-1),null==(e=k.current)||e.focus()},className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700",children:(0,t.jsx)(n.Qks,{size:18})})]})}),(0,t.jsxs)("div",{className:"max-h-96 overflow-y-auto",children:[x&&(0,t.jsx)("div",{className:"p-8 text-center",children:(0,t.jsxs)("div",{className:"inline-flex items-center gap-3 text-blue-600 dark:text-blue-400",children:[(0,t.jsx)("div",{className:"w-5 h-5 border-2 border-blue-600 dark:border-blue-400 border-t-transparent rounded-full animate-spin"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Поиск..."})]})}),!x&&c.trim().length>=2&&0===u.length&&(0,t.jsxs)("div",{className:"p-8 text-center",children:[(0,t.jsx)("div",{className:"text-gray-400 dark:text-gray-500 mb-3",children:(0,t.jsx)(n.uBk,{className:"w-12 h-12 mx-auto opacity-50"})}),(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 font-medium",children:"Ничего не найдено"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:"Попробуйте изменить поисковый запрос"})]}),!x&&u.length>0&&(0,t.jsx)("div",{className:"py-2",children:u.map((e,r)=>(0,t.jsx)("button",{onClick:()=>N(e),className:"w-full text-left px-6 py-4 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-all duration-150 border-l-4 border-transparent hover:border-blue-400 ".concat(r===g?"bg-blue-50 dark:bg-blue-900/20 border-blue-500":""),children:(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsx)("div",{className:"flex-shrink-0 w-10 h-10 bg-gradient-to-br from-blue-100 to-blue-200 dark:from-blue-800 dark:to-blue-900 rounded-lg flex items-center justify-center mt-0.5",children:(0,t.jsx)("svg",{className:"w-5 h-5 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("div",{className:"font-semibold text-gray-900 dark:text-gray-100 mb-1",children:e.title}),e.excerpt&&(0,t.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 line-clamp-2 leading-relaxed",children:e.excerpt})]})]})},e.id))}),c.trim().length<2&&(0,t.jsxs)("div",{className:"p-8 text-center",children:[(0,t.jsx)("div",{className:"text-gray-400 dark:text-gray-500 mb-3",children:(0,t.jsx)(n.uBk,{className:"w-12 h-12 mx-auto opacity-30"})}),(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Введите минимум 2 символа для поиска"})]})]}),(0,t.jsx)("div",{className:"px-6 py-4 bg-gray-50 dark:bg-gray-800/50 border-t border-gray-200 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-center gap-6 text-xs text-gray-500 dark:text-gray-400",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("kbd",{className:"px-2 py-1 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded text-xs font-mono",children:"↑↓"}),"для навигации"]}),(0,t.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("kbd",{className:"px-2 py-1 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded text-xs font-mono",children:"Enter"}),"для выбора"]}),(0,t.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("kbd",{className:"px-2 py-1 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded text-xs font-mono",children:"Esc"}),"для закрытия"]})]})})]})]})]})}},56584:(e,r,a)=>{"use strict";a.d(r,{U:()=>s});var t=a(95087);let s=()=>(0,t.createBrowserClient)("https://api.captain.software/","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1uaG9wcHdhanJxYmZod3R5aXZ6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTI3MzQ5MjQsImV4cCI6MjAyODMxMDkyNH0.-_70PEJOVst49q8oYxFOj3hgCegbCaYewmGa1umuOU0")}},e=>{e.O(0,[3795,5817,9494,5242,2728,1260,2941,5087,4427,3693,1294,1881,3402,9551,7530,9663,3624,9980,7358],()=>e(e.s=11896)),_N_E=e.O()}]);